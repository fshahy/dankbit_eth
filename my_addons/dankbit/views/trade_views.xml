<?xml version="1.0"?>

<odoo>
    <record id="dankbit_trade_view_form" model="ir.ui.view">
        <field name="name">dankbit_trade.view.form</field>
        <field name="model">dankbit.trade</field>
        <field name="arch" type="xml">
            <form string="Trade">
                <sheet>
                    <group>
                        <field name="name" />
                        <field name="option_type" />
                        <field name="strike" />
                        <field name="expiration" />
                        <field name="days_to_expiry" />
                        <field name="index_price" />
                        <field name="direction" />
                        <field name="amount" />
                        <field name="contracts" />
                        <field name="iv" />
                        <field name="deribit_ts" />
                        <field name="price" />
                        <field name="mark_price" />
                        <field name="trade_seq" />
                        <field name="deribit_trade_identifier" />
                        <field name="is_block_trade" />
                        <field name="block_trade_id" />
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="dankbit_trade_view_list" model="ir.ui.view">
        <field name="name">dankbit_trade.view.list</field>
        <field name="model">dankbit.trade</field>
        <field name="arch" type="xml">
            <list string="Trades">
                <field name="name" />
                <field name="deribit_ts" />
                <field name="strike" />
                <field name="amount" />
                <field name="contracts" />
                <field name="direction" />
                <field name="option_type" />
                <field name="days_to_expiry" />
                <field name="iv" />
                <field name="index_price" />
                <field name="is_block_trade" />
                <field name="block_trade_id" />
            </list>
        </field>
    </record>

    <record id="dankbit_trade_view_search" model="ir.ui.view">
        <field name="name">dankbit.trade.view.search</field>
        <field name="model">dankbit.trade</field>
        <field name="arch" type="xml">
            <search string="Search Trades">
                <field name="name" string="Name"/>
                <field name="strike" string="Strike"/>
                <field name="option_type" string="Option Type"/>
                <field name="direction" string="Direction"/>

                <separator/>
                <filter name="created_today" string="Created Today" domain="[
                    ('deribit_ts', '&gt;', datetime.datetime.combine(context_today(), datetime.time(0, 0, 0)))
                ]" />
                <separator/>
                <filter name="only_calls" string="Calls" domain="[('option_type', '=', 'call')]"/>
                <filter name="only_puts" string="Puts" domain="[('option_type', '=', 'put')]"/>
                <separator/>
                <filter name="only_longs" string="Buys" domain="[('direction', '=', 'buy')]"/>
                <filter name="only_sells" string="Sells" domain="[('direction', '=', 'sell')]"/>
                <separator/>
                <filter name="only_block_trades" string="Only Block Trades" domain="[('is_block_trade', '=', True)]"/>
                
                <group expand="0" string="Group By">
                    <filter string="Direction" name="direction" context="{'group_by':'direction'}"/>
                    <filter string="Option Type" name="option_type" context="{'group_by':'option_type'}"/>
                    <filter string="Block Trade" name="is_block_trade" context="{'group_by':'block_trade_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="dankbit_trade_action" model="ir.actions.act_window">
        <field name="name">Trades</field>
        <field name="res_model">dankbit.trade</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem id="dankbit_root_menu" name="Dankbit" sequence="10"/>

    <menuitem id="dankbit_trade_menu" name="Trades" 
        action="dankbit_trade_action"
        parent="dankbit_root_menu" 
        sequence="30"/>
</odoo>